# 2FAuth Helper Browser Extension

[中文](./README.md) | English

___

A browser extension for 2FAuth - view and manage your two-factor authentication codes conveniently in your browser.

## Features

- View all 2FA accounts
- Display OTP codes with auto-refresh
- One-click copy to clipboard
- Support for TOTP, HOTP, and Steam codes
- Scan QR codes from screen
- Upload QR code images
- Manual entry for adding accounts
- Import from other authenticator apps
- Search accounts
- Beautiful mobile-inspired interface
- Light/Dark theme support
- Chinese/English language switching
- Icon configuration when adding accounts manually (auto-fetch or upload custom icon)

## Installation

### Chrome / Edge / Brave

1. Download the extension folder
2. Open your browser extensions page:
   - Chrome: `chrome://extensions/`
   - Edge: `edge://extensions/`
   - Brave: `brave://extensions/`
3. Enable "Developer mode"
4. Click "Load unpacked"
5. Select the `2fauth-helper` folder

### Firefox

1. Open `about:debugging#/runtime/this-firefox`
2. Click "Load Temporary Add-on..."
3. Select the `manifest.json` file

## Prerequisites

This extension requires the 2FAuth Proxy server. Please deploy the proxy server and generate an access token first.

### 1. Deploy Proxy Server

Refer to `2fauth-proxy/README_EN.md` for deployment instructions.

### 2. Generate Token

```bash
docker exec 2fauth-proxy npm run generate-token
```

## Usage

### Initial Setup

1. Click the extension icon in your browser toolbar
2. Enter the proxy server URL (e.g., `http://localhost:3000`)
3. Click "Save & Continue"
4. Enter the token generated by the proxy server
5. Click "Login"

### View OTP Codes

1. Click on any account in the list
2. The current OTP code will be displayed
3. The code auto-refreshes when it expires
4. Click the copy button to copy to clipboard

### Add New Accounts

The extension provides multiple ways to add accounts:

#### Scan Screen QR Code

1. Display the QR code on a webpage
2. Click "Scan Screen QR" in the extension
3. The extension will automatically detect the QR code
4. Confirm the account info and click "Add Account"

#### Upload QR Image

1. Click "Upload QR Image"
2. Select an image file containing a QR code
3. Confirm the account info and click "Add Account"

#### Manual Entry

1. Click "Manual Entry"
2. Fill in service name, account, secret key, etc.
3. Optionally configure an icon for the account:
   - Click "Fetch Icon" to automatically get an icon based on the service name
   - Click "Upload" to upload a custom icon
   - Click the clear button to remove the icon
4. Click "Add Account"

#### Import Accounts

Supports importing from:

- Google Authenticator (via export QR code)
- 2FAS Authenticator
- Aegis Authenticator
- Other standard format authenticators

1. Click "Import Accounts"
2. Select the import source
3. Scan the export QR code or upload the export file

### Search Accounts

Type keywords in the search box at the top to quickly filter accounts.

### Theme and Language Settings

1. Click the settings button (gear icon) on the right side of the menu bar
2. In the settings page, you can choose:
   - **Language**: English / 中文
   - **Theme**: System / Light / Dark
3. Settings are automatically saved

### Logout

Click the user avatar in the top right corner and select "Logout".

## Security Notes

- The extension does not store your 2FAuth account credentials
- All OTP codes are calculated by the 2FAuth server; the extension only displays them
- Tokens are stored in browser local storage
- It's recommended to periodically rotate proxy tokens

## Notes

- This extension only supports viewing and adding accounts, not editing or deleting
- To edit or delete accounts, use the 2FAuth web interface
- Screen QR scanning requires granting screenshot permission to the extension

## Troubleshooting

### Cannot Connect to Server

1. Check if the proxy server is running
2. Verify the server URL is correct
3. Check network connectivity

### Invalid Token

1. Ensure the token is entered correctly (no extra spaces)
2. Token may have been invalidated (a new token was generated on the server); regenerate it:
   ```bash
   docker exec 2fauth-proxy npm run generate-token
   ```

### 2FAuth Connection Failed

If you see "2FAuth connection failed", the proxy server cannot connect to 2FAuth:

1. Check the proxy server environment variable configuration
2. Verify the 2FAuth server is running
3. Check proxy server logs for detailed error information

### QR Code Scan Failed

1. Ensure the QR code is fully visible on screen
2. Try enlarging the QR code
3. If screen scanning fails, try taking a screenshot and uploading it

## Technical Details

- Built with Manifest V3
- Uses jsQR library for QR code decoding
- Supports Chrome, Edge, Firefox, and other major browsers
